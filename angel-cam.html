<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SURFACE LIVE CAM // ANGEL SIGHTING</title>
  <meta name="description" content="地上監視ライブカメラ（使徒観測HUD）" />
  <style>
    :root{
      --bg:#05070a;
      --panel: rgba(0,0,0,.25);
      --cyan:#9ee7ff;
      --cyan2:#4bd4ff;
      --amber:#ffb14a;
      --amber2:#ff7a1a;
      --line: rgba(158,231,255,.55);
      --line2: rgba(158,231,255,.24);
      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      --sans: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, "Noto Sans JP", sans-serif;
      --glow: 0 0 18px rgba(75,212,255,.18);
      --glow2: 0 0 28px rgba(255,122,24,.14);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--cyan);
      font-family: var(--mono);
      background:
        radial-gradient(900px 600px at 50% 25%, rgba(75,212,255,.06), transparent 62%),
        radial-gradient(900px 600px at 20% 70%, rgba(255,122,24,.04), transparent 62%),
        var(--bg);
      overflow:hidden;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        repeating-linear-gradient(to bottom,
          rgba(255,255,255,.035), rgba(255,255,255,.035) 1px,
          rgba(0,0,0,0) 2px, rgba(0,0,0,0) 5px),
        radial-gradient(1200px 800px at 50% 45%, rgba(75,212,255,.10), transparent 65%);
      opacity:.18;
      mix-blend-mode: screen;
    }

    .wrap{position:fixed; inset:0; display:flex; align-items:center; justify-content:center;}
    .frame{
      width:1920px; height:1080px;
      transform: scale(var(--uiScale, 1));
      transform-origin: 50% 50%;
      position:relative;
      border:2px solid rgba(158,231,255,.38);
      background: linear-gradient(180deg, rgba(158,231,255,.03), transparent 38%), var(--panel);
      box-shadow: 0 26px 120px rgba(0,0,0,.62);
      overflow:hidden;
    }
    .frame::after{
      content:"";
      position:absolute; inset:10px;
      border:1px solid rgba(158,231,255,.18);
      pointer-events:none;
    }

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      padding: 10px 14px;
      border-bottom:1px solid rgba(158,231,255,.18);
      font-size:12px;
    }
    .chips{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid rgba(158,231,255,.28);
      background: rgba(158,231,255,.05);
      padding: 4px 10px;
      box-shadow: var(--glow);
      letter-spacing:.08em;
      user-select:none;
      white-space:nowrap;
    }
    .chip a{color:inherit; text-decoration:none}
    .chip--amber{border-color: rgba(255,122,24,.35); background: rgba(255,122,24,.06); color: var(--amber)}
    .chip--link{cursor:pointer}
    .chip--link:hover{background: rgba(158,231,255,.09)}

    .layout{
      display:grid;
      grid-template-columns: 360px 1fr;
      height: calc(1080px - 46px);
    }

    .side{
      border-right:1px solid rgba(158,231,255,.18);
      padding: 12px 12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .side h1{
      margin:0;
      font-family: var(--sans);
      font-size: 26px;
      letter-spacing:.06em;
      color: var(--amber);
      text-shadow: var(--glow2);
    }
    .side .desc{margin:2px 0 0; opacity:.78; font-size:12px; line-height:1.6}

    .camList{margin-top: 6px; display:flex; flex-direction:column; gap:8px;}
    .camBtn{
      text-align:left;
      border:1px solid rgba(158,231,255,.22);
      background: rgba(0,0,0,.22);
      color: inherit;
      padding: 10px 10px;
      font-family: var(--mono);
      cursor:pointer;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.30);
    }
    .camBtn:hover{background: rgba(158,231,255,.06)}
    .camBtn.active{border-color: rgba(255,122,24,.48); box-shadow: 0 0 0 2px rgba(255,122,24,.12) inset;}
    .camBtn .k{font-size:11px; opacity:.85}
    .camBtn .t{margin-top:4px; font-size:14px; font-weight:800; font-family: var(--sans); letter-spacing:.02em}
    .camBtn .s{margin-top:2px; font-size:11px; opacity:.70}

    .side .note{
      margin-top:auto;
      border:1px solid rgba(158,231,255,.18);
      background: rgba(158,231,255,.04);
      padding: 10px;
      font-size:11px;
      line-height:1.7;
      opacity:.86;
    }
    .side code{color: var(--amber)}

    .main{
      position:relative;
      overflow:hidden;
      background: #000;
    }
    .feed{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit: cover;
    }
    .feed.hidden{display:none}

    .fallback{
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 800px at 50% 50%, rgba(255,122,24,.08), transparent 55%),
        linear-gradient(180deg, rgba(158,231,255,.05), rgba(0,0,0,.35));
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: var(--sans);
      letter-spacing:.14em;
      font-weight:900;
      color: rgba(255,255,255,.55);
      text-transform:uppercase;
    }

    .hud{position:absolute; inset:0; pointer-events:none;}
    .hud::before{
      content:"";
      position:absolute; inset:0;
      background: repeating-linear-gradient(to bottom, rgba(255,255,255,.04) 0 1px, transparent 2px 6px);
      opacity:.08;
      mix-blend-mode: screen;
    }

    .reticle{
      position:absolute; left:50%; top:46%;
      width: 220px; height: 220px;
      transform: translate(-50%,-50%);
      filter: drop-shadow(0 0 10px rgba(255,122,24,.25));
      opacity:.95;
    }

    .scaleTop{
      position:absolute; left: 70px; right: 90px; top: 52px;
      height: 22px;
      border-top: 2px solid rgba(158,231,255,.65);
      display:flex;
      opacity:.88;
    }
    .scaleTop .tick{flex:1; position:relative; height:22px;}
    .scaleTop .tick::before{content:""; position:absolute; left:0; top:-2px; height: 12px; width:1px; background: rgba(158,231,255,.55);}
    .scaleTop .tick.big::before{height: 18px; background: rgba(158,231,255,.75)}
    .scaleTop .lbl{position:absolute; top: 6px; left: -12px; font-size: 11px; opacity:.85}

    .scaleRight{
      position:absolute; top: 90px; bottom: 120px; right: 56px;
      width: 22px;
      border-right: 2px solid rgba(158,231,255,.65);
      opacity:.88;
    }
    .scaleRight .rtick{position:absolute; right:-2px; width: 12px; height:1px; background: rgba(158,231,255,.55)}
    .scaleRight .rtick.big{width: 18px; background: rgba(158,231,255,.75)}
    .scaleRight .rlbl{position:absolute; right: 18px; transform: translateY(50%); font-size: 11px; opacity:.85;}

    .timeLeft{
      position:absolute; left: 70px; bottom: 70px;
      display:flex; align-items:center; gap:14px;
      color: rgba(158,231,255,.92);
      font-family: var(--mono);
      font-size: 22px;
      letter-spacing:.06em;
      text-shadow: 0 0 18px rgba(158,231,255,.20);
    }
    .bar10{display:flex; gap:3px;}
    .bar10 i{display:block; width:6px; height:16px; background: rgba(255,122,24,.65); box-shadow: 0 0 14px rgba(255,122,24,.22)}

    .timeRight{
      position:absolute; right: 80px; top: 170px;
      font-size: 18px;
      color: rgba(255,122,24,.92);
      text-shadow: 0 0 18px rgba(255,122,24,.18);
      letter-spacing:.06em;
    }

    .centerLabel{
      position:absolute; left:50%; bottom: 58px;
      transform: translateX(-50%);
      font-size: 14px;
      color: rgba(255,122,24,.92);
      letter-spacing:.12em;
      text-shadow: 0 0 18px rgba(255,122,24,.18);
    }

    .statusBox{
      position:absolute; left: 70px; top: 86px;
      border:1px solid rgba(158,231,255,.28);
      background: rgba(0,0,0,.20);
      padding: 8px 10px;
      font-size: 12px;
      letter-spacing:.08em;
      width: 360px;
    }
    .statusBox b{color: var(--amber)}

    .alertTag{
      position:absolute; left: 50%; top: 64px;
      transform: translateX(-50%);
      color: rgba(255,122,24,.92);
      font-size: 11px;
      letter-spacing:.22em;
      opacity:.95;
    }

    @keyframes jitter{0%,100%{transform:translate(0,0)} 50%{transform:translate(0.6px,-0.4px)}}
    .hudJitter{animation:jitter 1.6s infinite linear;}

    @media (max-width: 1200px){
      .layout{grid-template-columns: 1fr;}
      .side{display:none}
    }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="frame" id="frame">
      <div class="topbar">
        <div class="chips">
          <span class="chip chip--amber">SURFACE CAM</span>
          <span class="chip">MODE: <b>TRACKING</b></span>
          <span class="chip">TARGET: <b>ANGEL-LIKE</b></span>
        </div>
        <div class="chips">
          <span class="chip" id="camId">CAM: --</span>
          <span class="chip" id="camLoc">LOC: --</span>
          <span class="chip chip--link"><a href="stage-layer-map.html">CONSOLE</a></span>
          <span class="chip chip--link"><a href="index.html">QUIT</a></span>
        </div>
      </div>

      <div class="layout">
        <aside class="side">
          <h1>Angel Sighting</h1>
          <p class="desc">地上に現れた使徒を監視・追尾するための観測HUD。<br>ライブカメラ／静止画／ループ映像を差し替え可能。</p>

          <div class="camList" id="camList"></div>

          <div class="note">
            使い方：このページ内の <code>CAMS</code> 配列に、あなたのライブカメラURL（m3u8 / mp4 / iframe）またはローカル素材（assets/…）を設定。<br>
            ※GitHub Pagesでは、配信元のCORS設定によっては読み込めない場合があります。その場合は「静止画/ループ動画＋HUD」の方式が確実。
          </div>
        </aside>

        <section class="main" id="main">
          <video class="feed" id="v" autoplay muted playsinline loop></video>
          <img class="feed hidden" id="img" alt="cam" />
          <iframe class="feed hidden" id="ifr" title="cam" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          <div class="fallback" id="fallback">NO SIGNAL</div>

          <div class="hud hudJitter">
            <div class="alertTag">LIVE / TELEMETRY FEED</div>

            <div class="statusBox">
              <div>SYS: <b>OPS-LENS</b> / CH: <b id="ch">01</b></div>
              <div style="margin-top:6px; opacity:.85">SIGNATURE: <b>ACTIVE</b> / RANGE: <b id="rng">--</b> / LOCK: <b id="lock">--</b></div>
            </div>

            <svg class="reticle" viewBox="0 0 220 220" aria-hidden="true">
              <g fill="none" stroke="rgba(255,122,24,.92)" stroke-width="6" stroke-linecap="round">
                <path d="M110 26 v26"/>
                <path d="M110 168 v26"/>
                <path d="M26 110 h26"/>
                <path d="M168 110 h26"/>
              </g>
              <g fill="none" stroke="rgba(255,122,24,.92)" stroke-width="10" stroke-linecap="round">
                <path d="M95 110 h30"/>
              </g>
              <g fill="none" stroke="rgba(255,122,24,.35)" stroke-width="2">
                <circle cx="110" cy="110" r="72"/>
                <circle cx="110" cy="110" r="38"/>
              </g>
            </svg>

            <div class="scaleTop" id="scaleTop"></div>
            <div class="scaleRight" id="scaleRight"></div>

            <div class="timeLeft">
              <span class="bar10" aria-hidden="true">
                <i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i>
              </span>
              <span id="tc">00:0000:00</span>
            </div>
            <div class="timeRight"><span id="rt">00:00:00</span></div>
            <div class="centerLabel">CENTER</div>
          </div>
        </section>
      </div>
    </section>
  </main>

  <script>
    function fit(){
      const BASE_W=1920, BASE_H=1080;
      const sx = innerWidth/BASE_W;
      const sy = innerHeight/BASE_H;
      const sc = Math.max(0.25, Math.min(3, Math.max(sx, sy)));
      document.documentElement.style.setProperty('--uiScale', sc.toFixed(3));
    }
    addEventListener('resize', fit, {passive:true});
    addEventListener('load', fit);

    // kind: 'video' | 'image' | 'iframe'
        const CAMS = [
      { id:'EU-01', title:'SECTOR EU / SURFACE FEED-01', kind:'image', src:'assets/20260227_125457.jpg', status:'Nominal' },
      { id:'EU-02', title:'SECTOR EU / SURFACE FEED-02', kind:'image', src:'assets/20260227_125457.jpg', status:'Nominal' },
      { id:'EU-03', title:'SECTOR EU / SURFACE FEED-03', kind:'image', src:'assets/20260227_125457.jpg', status:'Nominal' },
      { id:'EU-04', title:'SECTOR EU / SURFACE FEED-04', kind:'image', src:'assets/20260227_125457.jpg', status:'Nominal' },
    ];

    const list = document.getElementById('camList');
    const v = document.getElementById('v');
    const img = document.getElementById('img');
    const ifr = document.getElementById('ifr');
    const fb = document.getElementById('fallback');
    const camId = document.getElementById('camId');
    const camLoc = document.getElementById('camLoc');

    function show(kind){
      v.classList.toggle('hidden', kind!=='video');
      img.classList.toggle('hidden', kind!=='image');
      ifr.classList.toggle('hidden', kind!=='iframe');
    }

    async function setCam(i){
      const cam = CAMS[i];
      if(!cam) return;
      document.querySelectorAll('.camBtn').forEach((b,idx)=>b.classList.toggle('active', idx===i));

      camId.textContent = 'CAM: ' + cam.id;
      camLoc.textContent = 'LOC: ' + cam.title;
      document.getElementById('ch').textContent = String(i+1).padStart(2,'0');

      v.pause(); v.removeAttribute('src');
      img.removeAttribute('src');
      ifr.removeAttribute('src');
      fb.style.display='none';

      const fail = ()=>{ fb.style.display='flex'; };

      try{
        if(cam.kind==='video'){
          show('video');
          v.src = cam.src;
          v.onerror = fail;
          await v.play();
        }else if(cam.kind==='image'){
          show('image');
          img.src = cam.src;
          img.onerror = fail;
        }else if(cam.kind==='iframe'){
          show('iframe');
          ifr.src = cam.src;
          ifr.onerror = fail;
        }
      }catch(e){
        fail();
      }

      document.getElementById('rng').textContent = (Math.random()*90+10).toFixed(1) + 'km';
      document.getElementById('lock').textContent = (Math.random()>.5?'ON':'OFF');
    }

    CAMS.forEach((c, i)=>{
      const b = document.createElement('button');
      b.type='button';
      b.className='camBtn';
      b.innerHTML = `<div class="k">${c.id} / ${c.status}</div><div class="t">${c.title}</div><div class="s">KIND: ${c.kind.toUpperCase()}</div>`;
      b.addEventListener('click', ()=>setCam(i));
      list.appendChild(b);
    });

    const scaleTop = document.getElementById('scaleTop');
    for(let i=0;i<=20;i++){
      const t = document.createElement('div');
      t.className='tick'+(i%5==0?' big':'');
      if(i%5==0){
        const l = document.createElement('div');
        l.className='lbl';
        l.textContent = String((i-10)*10);
        t.appendChild(l);
      }
      scaleTop.appendChild(t);
    }

    const scaleRight = document.getElementById('scaleRight');
    for(let i=0;i<=12;i++){
      const y = i/12;
      const tk = document.createElement('div');
      tk.className = 'rtick'+(i%3==0?' big':'');
      tk.style.top = (y*100)+'%';
      scaleRight.appendChild(tk);
      if(i%3==0){
        const lb = document.createElement('div');
        lb.className='rlbl';
        lb.style.top=(y*100)+'%';
        lb.textContent = String(60 - i*10);
        scaleRight.appendChild(lb);
      }
    }

    let t0 = performance.now();
    function tick(){
      const ms = performance.now()-t0;
      const frames = Math.floor(ms/16.666);
      const sec = Math.floor(frames/60);
      const f = frames%60;
      const m = Math.floor(sec/60);
      const s = sec%60;
      document.getElementById('tc').textContent = `00:${String(frames).padStart(4,'0')}:${String(f).padStart(2,'0')}`;
      document.getElementById('rt').textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}:${String(f).padStart(2,'0')}`;
      requestAnimationFrame(tick);
    }
    tick();

    setCam(0);
  </script>
</body>
</html>
